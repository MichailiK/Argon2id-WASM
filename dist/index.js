function y(){if(S===null||S.byteLength===0)S=new Uint8Array(Y.memory.buffer);return S}function x(I,H){return I=I>>>0,w.decode(y().subarray(I,I+H))}function d(I){if(R===V.length)V.push(V.length+1);const H=R;return R=V[H],V[H]=I,H}function f(I,H,D){if(D===void 0){const X=A.encode(I),L=H(X.length,1)>>>0;return y().subarray(L,L+X.length).set(X),W=X.length,L}let G=I.length,K=H(G,1)>>>0;const q=y();let Q=0;for(;Q<G;Q++){const X=I.charCodeAt(Q);if(X>127)break;q[K+Q]=X}if(Q!==G){if(Q!==0)I=I.slice(Q);K=D(K,G,G=Q+I.length*3,1)>>>0;const X=y().subarray(K+Q,K+G),L=p(I,X);Q+=L.written}return W=Q,K}function b(){if(k===null||k.byteLength===0)k=new Int32Array(Y.memory.buffer);return k}function g(I){return V[I]}function m(I){if(I<132)return;V[I]=R,R=I}function o(I){const H=g(I);return m(I),H}function c(I,H,D,G,K,q){let Q,X;try{const J=Y.__wbindgen_add_to_stack_pointer(-16),Z=f(I,Y.__wbindgen_malloc,Y.__wbindgen_realloc),z=W,M=f(H,Y.__wbindgen_malloc,Y.__wbindgen_realloc),P=W;Y.argon2id_hash(J,Z,z,M,P,D,G,K,q);var L=b()[J/4+0],T=b()[J/4+1],F=b()[J/4+2],E=b()[J/4+3],B=L,$=T;if(E)throw B=0,$=0,o(F);return Q=B,X=$,x(B,$)}finally{Y.__wbindgen_add_to_stack_pointer(16),Y.__wbindgen_free(Q,X,1)}}async function s(I,H){if(typeof Response==="function"&&I instanceof Response){if(typeof WebAssembly.instantiateStreaming==="function")try{return await WebAssembly.instantiateStreaming(I,H)}catch(G){if(I.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",G);else throw G}const D=await I.arrayBuffer();return await WebAssembly.instantiate(D,H)}else{const D=await WebAssembly.instantiate(I,H);if(D instanceof WebAssembly.Instance)return{instance:D,module:I};else return D}}function t(){const I={};return I.wbg={},I.wbg.__wbindgen_string_new=function(H,D){const G=x(H,D);return d(G)},I}function i(I,H){}function a(I,H){return Y=I.exports,_.__wbindgen_wasm_module=H,k=null,S=null,Y}async function _(I){if(Y!==void 0)return Y;if(typeof I==="undefined")I=new URL("argon2id_wasm_bg.wasm",import.meta.url);const H=t();if(typeof I==="string"||typeof Request==="function"&&I instanceof Request||typeof URL==="function"&&I instanceof URL)I=fetch(I);i(H);const{instance:D,module:G}=await s(await I,H);return a(D,G)}var Y,w=typeof TextDecoder!=="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};if(typeof TextDecoder!=="undefined")w.decode();var S=null,V=new Array(128).fill(void 0);V.push(void 0,null,!0,!1);var R=V.length,W=0,A=typeof TextEncoder!=="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},p=typeof A.encodeInto==="function"?function(I,H){return A.encodeInto(I,H)}:function(I,H){const D=A.encode(I);return H.set(D),{read:I.length,written:D.length}},k=null;var n=_;var N;((C)=>{function I(L){return btoa((L.match(/\w{2}/g)||[]).map(function(T){return String.fromCharCode(parseInt(T,16))}).join(""))}C.hexToBase64=I;function H(L){const T=atob(L);let F="";for(let E=0;E<T.length;E++){const B=T.charCodeAt(E).toString(16);F+=B.length===2?B:"0"+B}return F.toUpperCase()}C.base64ToHex=H;function D(L,T){var F=T-L,E=Math.ceil(Math.log2(F)/8);if(!E)return L;var B=Math.pow(256,E),$=new Uint8Array(E);while(!0){window.crypto.getRandomValues($);var J=0;for(var Z=0;Z<E;Z++)J=(J<<8)+$[Z];if(J<B-B%F)return L+J%F}}C.randRange=D;function G(){let L=16,T="abcdefghijklmnopqrstuvwxyz",F="ABCDEFGHIJKLMNOPQRSTUVWXYZ",E="1234567890",B=[];for(let $=0;$<L;$++)B.push(T.charAt(D(0,T.length)));for(let $=0;$<L/2;$++)B[D(0,B.length)]=F.charAt(D(0,F.length));for(let $=0;$<L/2;$++)B[D(0,B.length)]=E.charAt(D(0,E.length));return B.join("")}C.randomSalt=G,C.hash=async(L,T=N.randomSalt(),F=4,E=16,B=3,$=32)=>{if(E<=20)E=Math.pow(2,E);const J=async()=>{return await n(),c(L,T,F,E,B,$)};try{if(!window.Worker)return J();if(!(await fetch("argon2id_worker.js",{method:"HEAD"})).ok)return J();return await new Promise((z,M)=>{const P=new Worker("argon2id_worker.js",{type:"module"});P.onmessage=({data:v})=>{P.terminate(),v.error?M(v.error):z(v.output)},P.onerror=(v)=>{P.terminate(),M(`Worker error: ${v.message}`)},P.postMessage([L,T,F,E,B,$])})}catch{return J()}},C.hashEncoded=(L,T=N.randomSalt(),F=4,E=16,B=3,$=32)=>new Promise((J,Z)=>{if(E<=20)E=Math.pow(2,E);C.hash(L,T,F,E,B,$).then((z)=>{J(`\$argon2id\$v=19\$m=${E},t=${B},p=${F}\$${btoa(T).replaceAll("=","")}\$${I(z).replaceAll("=","")}`)}).catch((z)=>{Z(z)})});function Q(L){let T=L.split("$")[5];return H(T).toLowerCase()}C.hashDecode=Q,C.verify=(L,T)=>new Promise((F,E)=>{let B=L.split("$");if(B.length!=6)E("invalid hash");if(B[1]!="argon2id")E("unsupported algorithm");if(B[2]!="v=19")E("unsupported version");let $=B[3].split(",");if($.length!=3)E("invalid hash");let J=parseInt($[0].split("=")[1],10),Z=parseInt($[1].split("=")[1],10),z=parseInt($[2].split("=")[1],10),M=atob(B[4]),P=N.hashDecode(L);N.hash(T,M,z,J,Z,P.length/2).then((v)=>{F(v===P)}).catch((v)=>{E(v)})})})(N||={});var U=N;function h(I){return Date.now()-I}var l=document.getElementById("salt"),e=document.getElementById("message"),r=document.getElementById("message2"),II=document.getElementById("p"),HI=document.getElementById("m"),LI=document.getElementById("t"),EI=document.getElementById("l"),BI=document.getElementById("hashEncoded"),u=document.getElementById("hash"),O=document.getElementById("perf"),j=document.getElementById("validate");l.value=U.randomSalt();document.getElementById("hashForm")?.addEventListener("submit",(I)=>{if(I.preventDefault(),!u||!O)return;let H=e.value,D=l.value,G=parseInt(II.value,10),K=parseInt(HI.value,10),q=parseInt(LI.value,10),Q=parseInt(EI.value,10),X=Date.now();U.hashEncoded(H,D,G,K,q,Q).then((L)=>{let T=U.hashDecode(L),F=h(X);u.innerHTML="<b>Hash:</b> "+T+"<br/><b>Hash Encoded:</b> "+L,O.innerHTML="Hashing the message took <b>"+F+"ms</b>."}).catch((L)=>{u.innerHTML=`Hashing failed because of <b>${L}</b>`,O.innerHTML=""})});document.getElementById("verifyForm")?.addEventListener("submit",(I)=>{if(I.preventDefault(),!O||!j)return;let H=r.value,D=BI.value,G=Date.now();U.verify(D,H).then((K)=>{let q=h(G);if(K)j.innerHTML="The message <b>DOES</b> match the supplied hash.";if(!K)j.innerHTML="The message does <b>NOT</b> match the supplied hash.";O.innerHTML="Verifying the message took <b>"+q+"ms</b>."}).catch((K)=>{j.innerHTML=`Validation failed because of <b>${K}</b>`,O.innerHTML=""})});
