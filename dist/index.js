var O=function(){if(k===null||k.byteLength===0)k=new Uint8Array(D.memory.buffer);return k},M=function(K,G){return K=K>>>0,A.decode(O().subarray(K,K+G))},c=function(K){if(V===F.length)F.push(F.length+1);const G=V;return V=F[G],F[G]=K,G},b=function(K,G,Q){if(Q===void 0){const Z=U.encode(K),$=G(Z.length,1)>>>0;return O().subarray($,$+Z.length).set(Z),W=Z.length,$}let J=K.length,P=G(J,1)>>>0;const X=O();let Y=0;for(;Y<J;Y++){const Z=K.charCodeAt(Y);if(Z>127)break;X[P+Y]=Z}if(Y!==J){if(Y!==0)K=K.slice(Y);P=Q(P,J,J=Y+K.length*3,1)>>>0;const Z=O().subarray(P+Y,P+J),$=g(K,Z);Y+=$.written}return W=Y,P},N=function(){if(R===null||R.byteLength===0)R=new Int32Array(D.memory.buffer);return R},p=function(K){return F[K]},l=function(K){if(K<132)return;F[K]=V,V=K},o=function(K){const G=p(K);return l(K),G};function j(K,G,Q,J,P,X){let Y,Z;try{const L=D.__wbindgen_add_to_stack_pointer(-16),f=b(K,D.__wbindgen_malloc,D.__wbindgen_realloc),_=W,u=b(G,D.__wbindgen_malloc,D.__wbindgen_realloc),h=W;D.argon2id_hash(L,f,_,u,h,Q,J,P,X);var $=N()[L/4+0],z=N()[L/4+1],q=N()[L/4+2],C=N()[L/4+3],T=$,v=z;if(C)throw T=0,v=0,o(q);return Y=T,Z=v,M(T,v)}finally{D.__wbindgen_add_to_stack_pointer(16),D.__wbindgen_free(Y,Z,1)}}async function d(K,G){if(typeof Response==="function"&&K instanceof Response){if(typeof WebAssembly.instantiateStreaming==="function")try{return await WebAssembly.instantiateStreaming(K,G)}catch(J){if(K.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",J);else throw J}const Q=await K.arrayBuffer();return await WebAssembly.instantiate(Q,G)}else{const Q=await WebAssembly.instantiate(K,G);if(Q instanceof WebAssembly.Instance)return{instance:Q,module:K};else return Q}}var i=function(){const K={};return K.wbg={},K.wbg.__wbindgen_string_new=function(G,Q){const J=M(G,Q);return c(J)},K},s=function(K,G){},n=function(K,G){return D=K.exports,y.__wbindgen_wasm_module=G,R=null,k=null,D};async function y(K){if(D!==void 0)return D;if(typeof K==="undefined")K=new URL("argon2id_wasm_bg.wasm",import.meta.url);const G=i();if(typeof K==="string"||typeof Request==="function"&&K instanceof Request||typeof URL==="function"&&K instanceof URL)K=fetch(K);s(G);const{instance:Q,module:J}=await d(await K,G);return n(Q,J)}var D,A=typeof TextDecoder!=="undefined"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};if(typeof TextDecoder!=="undefined")A.decode();var k=null,F=new Array(128).fill(void 0);F.push(void 0,null,!0,!1);var V=F.length,W=0,U=typeof TextEncoder!=="undefined"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},g=typeof U.encodeInto==="function"?function(K,G){return U.encodeInto(K,G)}:function(K,G){const Q=U.encode(K);return G.set(Q),{read:K.length,written:Q.length}},R=null;var w=y;class H{static hexToBase64(K){return btoa((K.match(/\w{2}/g)||[]).map(function(G){return String.fromCharCode(parseInt(G,16))}).join(""))}static base64ToHex(K){const G=atob(K);let Q="";for(let J=0;J<G.length;J++){const P=G.charCodeAt(J).toString(16);Q+=P.length===2?P:"0"+P}return Q.toUpperCase()}static randRange(K,G){var Q=G-K,J=Math.ceil(Math.log2(Q)/8);if(!J)return K;var P=Math.pow(256,J),X=new Uint8Array(J);while(!0){window.crypto.getRandomValues(X);var Y=0;for(var Z=0;Z<J;Z++)Y=(Y<<8)+X[Z];if(Y<P-P%Q)return K+Y%Q}}static randomSalt(){let K=16,G="abcdefghijklmnopqrstuvwxyz",Q="ABCDEFGHIJKLMNOPQRSTUVWXYZ",J="1234567890",P=[];for(let X=0;X<K;X++)P.push(G.charAt(this.randRange(0,G.length)));for(let X=0;X<K/2;X++)P[this.randRange(0,P.length)]=Q.charAt(this.randRange(0,Q.length));for(let X=0;X<K/2;X++)P[this.randRange(0,P.length)]=J.charAt(this.randRange(0,J.length));return P.join("")}static hash=(K,G=H.randomSalt(),Q=4,J=16,P=3,X=32)=>new Promise((Y,Z)=>{if(J<=20)J=Math.pow(2,J);if(window.Worker){const $=new Worker("argon2id_worker.js",{type:"module"});$.onmessage=({data:z})=>{if($.terminate(),z.error)Z(z.error);Y(z.output)},$.postMessage([K,G,Q,J,P,X])}else w().then(()=>{Y(j(K,G,Q,J,P,X))}).catch(($)=>{Z($)})});static hashEncoded=(K,G=H.randomSalt(),Q=4,J=16,P=3,X=32)=>new Promise((Y,Z)=>{if(J<=20)J=Math.pow(2,J);this.hash(K,G,Q,J,P,X).then(($)=>{Y(`\$argon2id\$v=19\$m=${J},t=${P},p=${Q}\$${btoa(G).replaceAll("=","")}\$${this.hexToBase64($).replaceAll("=","")}`)}).catch(($)=>{Z($)})});static hashDecode(K){let G=K.split("$")[5];return this.base64ToHex(G).toLowerCase()}static verify=(K,G)=>new Promise((Q,J)=>{let P=K.split("$");if(P.length!=6)J("invalid hash");if(P[1]!="argon2id")J("unsupported algorithm");if(P[2]!="v=19")J("unsupported version");let X=P[3].split(",");if(X.length!=3)J("invalid hash");let Y=parseInt(X[0].split("=")[1],10),Z=parseInt(X[1].split("=")[1],10),$=parseInt(X[2].split("=")[1],10),z=atob(P[4]),q=H.hashDecode(K);H.hash(G,z,$,Y,Z,q.length/2).then((C)=>{Q(C===q)}).catch((C)=>{J(C)})})}var E=function(K){return Date.now()-K},x=document.getElementById("salt"),m=document.getElementById("message"),a=document.getElementById("message2"),r=document.getElementById("p"),t=document.getElementById("m"),e=document.getElementById("t"),K0=document.getElementById("l"),G0=document.getElementById("hashEncoded"),I=document.getElementById("hash"),B=document.getElementById("perf"),S=document.getElementById("validate");x.value=H.randomSalt();document.getElementById("hashForm")?.addEventListener("submit",(K)=>{if(K.preventDefault(),!I||!B)return;let G=m.value,Q=x.value,J=parseInt(r.value,10),P=parseInt(t.value,10),X=parseInt(e.value,10),Y=parseInt(K0.value,10),Z=Date.now();H.hashEncoded(G,Q,J,P,X,Y).then(($)=>{let z=H.hashDecode($),q=E(Z);I.innerHTML="<b>Hash:</b> "+z+"<br/><b>Hash Encoded:</b> "+$,B.innerHTML="Hashing the message took <b>"+q+"ms</b>."}).catch(($)=>{I.innerHTML=`Hashing failed because of <b>${$}</b>`,B.innerHTML=""})});document.getElementById("verifyForm")?.addEventListener("submit",(K)=>{if(K.preventDefault(),!B||!S)return;let G=a.value,Q=G0.value,J=Date.now();H.verify(Q,G).then((P)=>{let X=E(J);if(P)S.innerHTML="The message <b>DOES</b> match the supplied hash.";if(!P)S.innerHTML="The message does <b>NOT</b> match the supplied hash.";B.innerHTML="Verifying the message took <b>"+X+"ms</b>."}).catch((P)=>{S.innerHTML=`Validation failed because of <b>${P}</b>`,B.innerHTML=""})});
